asyncapi: 3.0.0
info:
  title: AAS SubmodelElement ASYNC API with CloudEvents
  version: 0.3-SNAPSHOT
channels:
  submodelelement/update/valuechanged:
    address: >-
      uri:submodels/base64{submodelid}/submodel-elements/{idshortpath}
    messages:
      publish.message:
        $ref: '#/components/messages/valueChanged'
    parameters:
      submodelid:
        $ref: '#/components/parameters/submodelid'
      idshortpath:
        $ref: '#/components/parameters/idshortpath'
operations:
  submodelelement/update/valuechanged.publish:
    action: send
    channel:
      $ref: '#/channels/submodelelement~1update~1valuechanged'
    messages:
      - $ref: '#/channels/submodelelement~1update~1valuechanged/messages/publish.message'
components:
  messages:
    valueChanged:
      name: SubmodelElementValueChanged
      title: SubmodelElement Value Change message
      summary: Emitted when the 'value' field of a submodel element is changed
      payload:
        $ref: '#/components/schemas/valueChangedEvent'
  parameters:
    submodelid:
      description: The ID of the submodel from which the event originates.
    idshortpath:
      description: The idShortPath to the emitting SubmodelElement.
  schemas:
    valueChangedEvent:
      properties:
        specversion:
          description: The version of the CloudEvents specification which the event uses.
          type: string
          const: '1.0'
        id:
          description: Identifies the event.
          type: string
          examples:
            - 358c02f2-3a11-4836-971b-43a05550bf97
        source:
          description: The URL the emitting Referable can be obtained from.
          type: string
          pattern: ^https?:\/\/[^\s/$.?#].[^\s]*$
          examples:
            - 'https://providercorp.com/submodels/b64encoded-id/submodel-elements/idshort.path.to.emitting.dataelelement'
        type:
          description: >-
            Describes the type of the event related to the source the event
            originated in.
          type: string
          examples:
            - io.admin-shell.events.v1.PropertyValueChanged
            - io.admin-shell.events.v1.FileValueChanged
        datacontenttype:
          description: Content type of the event data.
          type: string
          const: application/json
        dataschema:
          description: Identifies the schema that the event data adheres to.
          type: string
          format: uri
          examples:
            - >-
              https://api.swaggerhub.com/domains/Plattform_i40/Part1-MetaModel-Schemas/V3.1.0#/components/schemas/Property
            - >-
              https://api.swaggerhub.com/domains/Plattform_i40/Part1-MetaModel-Schemas/V3.1.0#/components/schemas/File
        time:
          description: Timestamp of when the occurrence happened.
          format: date-time
          type: string
          examples:
            - '2025-09-25T13:37:12.3456789+01:00'
        semanticid:
          description: The semanticId of the submodel from which the event was emitted, if available. (This property may hold the entry in the semanticId's `keys`-array at index 0)
          type: string
          examples:
            - "0173-1#02-AAA119#002"
        data:
          $ref: '#/components/schemas/valueChangedEventData'
      required:
        - specversion
        - id
        - source
        - type
        - datacontenttype
        - dataschema
        - time
      optional:
        - data
        - semanticid
    valueChangedEventData:
          type: object
          properties:
            oldValue:
              type: 
                - string
                - number
              examples:
                - 41
            newValue:
              type: 
                - string
                - number
              examples:
                - 42