asyncapi: 3.0.0
info:
  title: AAS Submodel ASYNC API with CloudEvents
  version: 0.3-SNAPSHOT
channels:
  submodel/updated:
    address: noauth or all or participantid
    messages:
      publish.message:
        $ref: '#/components/messages/updated'
    parameters:
      submodelid:
        $ref: '#/components/parameters/submodelid'
  submodel/created:
    address: noauth or all or participantid
    messages:
      publish.message:
        $ref: '#/components/messages/created'
    parameters:
      submodelid:
        $ref: '#/components/parameters/submodelid'
  submodel/deleted:
    address: noauth or all or participantid
    messages:
      publish.message:
        $ref: '#/components/messages/deleted'
    parameters:
      submodelid:
        $ref: '#/components/parameters/submodelid'
operations:
  submodel/updated.publish:
    action: send
    channel:
      $ref: '#/channels/submodel~1updated'
    messages:
      - $ref: '#/channels/submodel~1updated/messages/publish.message'
  submodel/created.publish:
    action: send
    channel:
      $ref: '#/channels/submodel~1created'
    messages:
      - $ref: '#/channels/submodel~1created/messages/publish.message'
  submodel/deleted.publish:
    action: send
    channel:
      $ref: '#/channels/submodel~1deleted'
    messages:
      - $ref: '#/channels/submodel~1deleted/messages/publish.message'
components:
  messages:
    updated:
      name: SubmodelUpdated
      title: Submodel Update message
      summary: Emitted when the metadata of a submodel is updated
      payload:
        $ref: '#/components/schemas/updatedEvent'
    created:
      name: SubmodelCreated
      title: Submodel Create message
      summary: Emitted when a submodel is created
      payload:
        $ref: '#/components/schemas/createdEvent'
    deleted:
      name: SubmodelDeleted
      title: Submodel Delete message
      summary: Emitted when a submodel is deleted
      payload:
        $ref: '#/components/schemas/deletedEvent'
  parameters:
    submodelid:
      description: The Id of the submodel in the Asset Administration Shell with aasId.
  schemas:
    updatedEvent:
      properties:
        specversion:
          description: The version of the CloudEvents specification which the event uses.
          type: string
          const: '1.0'
        id:
          description: Identifies the event.
          type: string
          examples:
            - 358c02f2-3a11-4836-971b-43a05550bf97
        source:
          description: The URL the emitting Referable can be obtained from. The element must be of the type indicated in the `dataschema` property.
          type: string
          pattern: ^https?:\/\/[^\s/$.?#].[^\s]*$
          examples:
            - 'https://providercorp.com/submodels/abcdef'
        type:
          description: >-
            Describes the type of the event related to the source the event
            originated in.
          type: string
          enum:
            - io.admin-shell.events.v1.updated
        datacontenttype:
          description: Content type of the event data.
          type: string
          const: application/json
        dataschema:
          description: Identifies the schema that the event data adheres to.
          type: string
          format: uri
          enum:
            - >-
              https://api.swaggerhub.com/domains/Plattform_i40/Part1-MetaModel-Schemas/V3.1.0#/components/schemas/Submodel
        time:
          description: Timestamp of when the occurrence happened.
          format: date-time
          type: string
          examples:
            - '2024-11-26T10:46:33.2171298+01:00'
        semanticid:
          description: If a semanticId exists on the payload, this property may hold the entry in the `keys`-array at index 0.
          type: string
          examples:
            - "0173-1#02-AAA119#002"
        data:
          $ref: '#/components/schemas/submodelEventData'
      required:
        - specversion
        - id
        - source
        - type
        - datacontenttype
        - dataschema
        - time
      optional:
        - data
        - semanticid
    createdEvent:
      properties:
        specversion:
          description: The version of the CloudEvents specification which the event uses.
          type: string
          const: '1.0'
        id:
          description: Identifies the event.
          type: string
          examples:
            - 358c02f2-3a11-4836-971b-43a05550bf97
        source:
          description: The URL the emitting Referable can be obtained from. The element must be of the type indicated in the `dataschema` property.
          type: string
          pattern: ^https?:\/\/[^\s/$.?#].[^\s]*$
          examples:
            - 'https://providercorp.com/submodels/abcdef'
        type:
          description: >-
            Describes the type of the event related to the source the event
            originated in.
          type: string
          enum:
            - io.admin-shell.events.v1.created
        datacontenttype:
          description: Content type of the event data.
          type: string
          const: application/json
        dataschema:
          description: Identifies the schema that the event data adheres to.
          type: string
          format: uri
          enum:
            - >-
              https://api.swaggerhub.com/domains/Plattform_i40/Part1-MetaModel-Schemas/V3.1.0#/components/schemas/Submodel
        time:
          description: Timestamp of when the occurrence happened.
          format: date-time
          type: string
          examples:
            - '2024-11-26T10:46:33.2171298+01:00'
        semanticid:
          description: If a semanticId exists on the payload, this property may hold the entry in the `keys`-array at index 0.
          type: string
          examples:
            - "0173-1#02-AAA119#002"
        data:
          $ref: '#/components/schemas/submodelEventData'
      required:
        - specversion
        - id
        - source
        - type
        - datacontenttype
        - dataschema
        - time
      optional:
        - data
        - semanticid
    deletedEvent:
      properties:
        specversion:
          description: The version of the CloudEvents specification which the event uses.
          type: string
          const: '1.0'
        id:
          description: Identifies the event.
          type: string
          examples:
            - 358c02f2-3a11-4836-971b-43a05550bf97
        source:
          description: The URL the emitting Referable can be obtained from. The element must be of the type indicated in the `dataschema` property.
          type: string
          pattern: ^https?:\/\/[^\s/$.?#].[^\s]*$
          examples:
            - 'https://providercorp.com/submodels/abcdef'
        type:
          description: >-
            Describes the type of the event related to the source the event
            originated in.
          type: string
          enum:
            - io.admin-shell.events.v1.deleted
        datacontenttype:
          description: Content type of the event data.
          type: string
          const: application/json
        dataschema:
          description: Identifies the schema that the event data adheres to.
          type: string
          format: uri
          enum:
            - >-
              https://api.swaggerhub.com/domains/Plattform_i40/Part1-MetaModel-Schemas/V3.1.0#/components/schemas/Submodel
        time:
          description: Timestamp of when the occurrence happened.
          format: date-time
          type: string
          examples:
            - '2024-11-26T10:46:33.2171298+01:00'
        semanticid:
          description: If a semanticId exists on the payload, this property may hold the entry in the `keys`-array at index 0.
          type: string
          examples:
            - "0173-1#02-AAA119#002"
        data:
          $ref: '#/components/schemas/submodelEventData'
      required:
        - specversion
        - id
        - source
        - type
        - datacontenttype
        - dataschema
        - time
      optional:
        - data
        - semanticid
    submodelEventData:
      type: object
      properties:
        submodel:
          description: the affected submodel in full